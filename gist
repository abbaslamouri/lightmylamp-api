docker build -t api .

docker run -v /Users/abbaslamouri/Desktop/Sandbox/node/api-ts:/app -p 5000:5000 --name apic api
docker run -v $(pwd):/app -v /app/node_modules --env-file ./.env -p 5000:5000 --name apic api

#ro may not work

docker container prune -f
docker container prune -fv

docker image prune -a

docker exec -it lightmylamp-api-api-1 bash
docker exec -it lightmylamp-api-redis-1 bash

lightmylamp-api-redis-1

  REDIS_IP: process.env.REDIS_IP || 'redis',


docker-compose -f docker-compose.yml -f docker-compose.dev.yml up -d --build
docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d --build
docker compose -f docker-compose.yml -f docker-compose.prod.yml up -d --build --scale api=3 --no-deps api




docker-compose down 

mongo -u "lightmylamp-db-user" -p "Wjshg^&JXslsp"

printenv



docker image tag lightmylamp-api_api abbaslamouri/lightmylamp-api

// Build api service image to push to docker hub
docker compose -f docker-compose.yml -f docker-compose.prod.yml build api

// Push service to docker hub
docker compose -f docker-compose.yml -f docker-compose.prod.yml push api

// Pull service to docker hub
docker compose -f docker-compose.yml -f docker-compose.prod.yml pull api

// update api container
docker compose -f docker-compose.yml -f docker-compose.prod.yml up -d --scale api=3 --no-deps api

// Watchtower
docker run -d -e WATCHTOWER_TRACE=true -e WATCHTOWER_DEBUG=true -e WATCHTOWER_POLL_INTERVAL=20 --name watchtower -v /var/run/docker.sock:/var/run/docker.sock containrrr/watchtower <container> 

// Docker settings
docker info



// Initialize docker swarm
docker swarm init

ip add

docker swarm init --advertise-addr 159.223.108.41

docker swarm init --advertise-addr 172.30.0.1



To add a worker to this swarm, run the following command:

    docker swarm join --token SWMTKN-1-4grcp95eo9yzfhkyedafpm70ebppmoniba9oxlpenswwfn3lye-avogp3tozr5mhak6r4fs82ruh 159.223.108.41:2377

To add a manager to this swarm, run 'docker swarm join-token manager' and follow the instructions.

docker stack deploy -c docker-compose.yml -c docker-compose.prod.yml lightmylamp

docker stack services lightmylamp

docker swarm leave -f



